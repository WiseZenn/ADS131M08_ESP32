# ADS131M08 Driver for ESP32

[![Arduino](https://img.shields.io/badge/Arduino-ESP32-blue.svg)](https://github.com/espressif/arduino-esp32)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Version](https://img.shields.io/badge/version-1.0.0-orange.svg)](library.properties)

High-performance Arduino library for the **Texas Instruments ADS131M08** (8-Channel, 24-bit Delta-Sigma ADC), specifically optimized for the **ESP32/ESP32-S3** microcontroller.

> **Key Feature**: This library generates the required 8.192MHz (or 8MHz) master clock (MCLK) directly using the ESP32's **LEDC (PWM)** peripheral, eliminating the need for an external crystal oscillator.

## ‚ú® Features

- **8-Channel Simultaneous Sampling**: Reads all 8 channels efficiently.
- **24-bit High Resolution**: Support for full 24-bit data parsing.
- **Built-in Clock Generation**: Uses ESP32 hardware PWM (LEDC) to generate MCLK.
- **High-Speed SPI**: Optimized for fast data retrieval.
- **Data Ready Interrupt**: Efficient non-blocking data reading via DRDY pin.

## üîå Wiring & Hardware

### Connection Diagram

![Wiring Diagram](extras/ADS131M08.png)

*For detailed schematic information, please refer to [ADS131M08_Schematic.pdf](extras/ADS131M08_Schematic.pdf)*

## üîó Documentation

- **Official Datasheet & Product Page**: [Texas Instruments ADS131M08](https://www.ti.com.cn/product/cn/ADS131M08)

### Pin Mapping (ESP32-S3 R8 Example)

| ADS131 Pin | ESP32-S3 Pin | Description |
| :--- | :--- | :--- |
| **AVDD/DVDD** | 3.3V | Power Supply |
| **GND** | GND | Ground |
| **MCLK** | GPIO 4 | **Clock Input** (Generated by ESP32 LEDC) |
| **SCLK** | GPIO 12 | SPI Clock |
| **MOSI (DIN)** | GPIO 11 | SPI Data In |
| **MISO (DOUT)**| GPIO 13 | SPI Data Out |
| **CS** | GPIO 10 | Chip Select |
| **DRDY** | GPIO 9 | Data Ready Interrupt |

*Note: Pins are fully configurable in the software constructor.*

## üì¶ Installation

1. Download this repository as a `.zip` file.
2. In Arduino IDE, go to **Sketch** -> **Include Library** -> **Add .ZIP Library...**
3. Select the downloaded file.

## üöÄ Usage

```cpp
#include <ADS131M08.h>

// Pin Definitions (Example based on ESP32-S3)
#define CLK_PIN  4  // MCLK generated by ESP32
#define CS_PIN   10
#define DRDY_PIN 9
#define MOSI_PIN 11
#define MISO_PIN 13
#define SCLK_PIN 12

// Initialize Driver
ADS131M08 adc(CLK_PIN, CS_PIN, DRDY_PIN, MOSI_PIN, MISO_PIN, SCLK_PIN);

void setup() {
    Serial.begin(115200);
    
    // Start ADC and Clock
    adc.begin();
    Serial.println("ADS131M08 Initialized");
}

void loop() {
    if (adc.isDataReady()) {
        ADS131Data data;
        if (adc.readData(data)) {
            // Print Channel 0 Voltage
            float voltage = ADS131M08::rawToVoltage(data.ch[0]);
            Serial.printf("CH0: %.4f V\n", voltage);
        }
    }
}
```

## ‚ö†Ô∏è Compatibility Note

This library uses the ESP-IDF `driver/ledc.h` API for clock generation.
- **Tested on**: ESP32-S3 (R8)
- **Arduino Core**: Recommended v2.0.x (v3.0+ may require API updates for LEDC)

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---
**Author**: WiseZenn
